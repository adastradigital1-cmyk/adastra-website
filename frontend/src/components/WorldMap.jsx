import React from 'react';

// Dot-matrix world map data (72 cols x 36 rows, 1=land, 0=water)
const mapData = [
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000001111000000000000000000001111111100000000000000000000000',
  '000000000000000011111100000000000000000011111111110000000000000000000000',
  '000000001111111111111100000000000011111111111111111100000000000000000000',
  '000000011111111111111100000000001111111111111111111110000000000000000000',
  '000000011111111111111000000000011111111111111111111111100000000000000000',
  '000000111111111111111000000000011111111111111111111111110000000000000000',
  '000001111111111111110000000000011111111111111111111111111000000000000000',
  '000001111111111111110000000000001111111111111111111111111000000000000000',
  '000011111111111111100000000000001111111111111111111111111000000000000000',
  '000011111111111111100000000000000111111111111111111111111100000000000000',
  '000011111111111111100000000000000011111111111111111111111000000000000000',
  '000001111111111111100000000000000011111111111111111111110000000000000000',
  '000000111111111111100000000000000001111111111111111111100000000000000000',
  '000000011111111110000000000000000001111111111111111111000000000000000000',
  '000000001111111100000000000000000001111111111111111110000000000000000000',
  '000000000111110000000000000000000000111111111111111100000000000000000000',
  '000000000011100000000000000000000000011111111111111100000000000000000000',
  '000000000011100000000000000000000000001111111111111100000000000000000000',
  '000000000001110000000000000000000000000111111111111000000000000000000000',
  '000000000001110000000000000000000000000011111111111000000001100000000000',
  '000000000001110000000000000000000000000001111111100000000011110000000000',
  '000000000000110000000000000000000000000000111111000000000111111000000000',
  '000000000000110000000000000000000000000000011110000000001111111100000000',
  '000000000000010000000000000000000000000000001100000000001111111100000000',
  '000000000000010000000000000000000000000000000000000000000111111100000000',
  '000000000000000000000000000000000000000000000000000000000111111000000000',
  '000000000000000000000000000000000000000000000000000000000011110000000000',
  '000000000000000000000000000000000000000000000000000000000001100000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
  '000000000000000000000000000000000000000000000000000000000000000000000000',
];

const offices = [
  { name: 'Bangalore', col: 48.5, row: 16.5 },
  { name: 'Hyderabad', col: 48, row: 15 },
  { name: 'Kolkata', col: 50.5, row: 14 },
  { name: 'Mumbai', col: 46.5, row: 15 },
  { name: 'New Delhi', col: 47.5, row: 12.5 },
  { name: 'Coimbatore', col: 48, row: 17.5 },
  { name: 'Singapore', col: 55.5, row: 19 },
  { name: 'London', col: 34.5, row: 6 },
  { name: 'Amsterdam', col: 35.5, row: 5.5 },
];

const COLS = 72;
const ROWS = 36;

export const WorldMap = () => {
  const dotSize = 0.35;
  const gap = 1.4;

  return (
    <div className="relative w-full" data-testid="world-map">
      <svg
        viewBox={`0 0 ${COLS * gap} ${ROWS * gap}`}
        className="w-full h-auto"
        preserveAspectRatio="xMidYMid meet"
      >
        {/* Land dots */}
        {mapData.map((row, ry) =>
          row.split('').map((cell, cx) => {
            if (cell !== '1') return null;
            return (
              <circle
                key={`${ry}-${cx}`}
                cx={cx * gap + gap / 2}
                cy={ry * gap + gap / 2}
                r={dotSize}
                fill="var(--text-on-dark-muted)"
                opacity="0.18"
              />
            );
          })
        )}

        {/* Office location markers */}
        {offices.map((loc) => (
          <g key={loc.name}>
            {/* Pulse ring */}
            <circle
              cx={loc.col * gap + gap / 2}
              cy={loc.row * gap + gap / 2}
              r={dotSize * 2}
              fill="none"
              stroke="var(--orange-core)"
              strokeWidth="0.15"
              opacity="0.5"
            >
              <animate attributeName="r" values={`${dotSize * 2};${dotSize * 5};${dotSize * 2}`} dur="2.5s" repeatCount="indefinite" />
              <animate attributeName="opacity" values="0.5;0;0.5" dur="2.5s" repeatCount="indefinite" />
            </circle>
            {/* Solid dot */}
            <circle
              cx={loc.col * gap + gap / 2}
              cy={loc.row * gap + gap / 2}
              r={dotSize * 1.5}
              fill="var(--orange-core)"
            />
          </g>
        ))}
      </svg>
    </div>
  );
};
